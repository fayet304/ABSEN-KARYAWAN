<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Absensi & Izin Karyawan</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    header {
      background: #007BFF;
      color: white;
      text-align: center;
      padding: 10px;
    }
    nav {
      display: flex;
      justify-content: space-around;
      background: #eee;
    }
    nav button {
      flex: 1;
      padding: 10px;
      border: none;
      background: #ddd;
      cursor: pointer;
    }
    nav button.active {
      background: #007BFF;
      color: white;
      font-weight: bold;
    }
    section {
      display: none;
      padding: 20px;
    }
    section.active {
      display: block;
    }
    input, select, button {
      display: block;
      margin: 10px 0;
      padding: 8px;
      width: 100%;
      max-width: 400px;
    }
  </style>
</head>
<body>

<header>
  <h1>Sistem Absensi & Izin Karyawan</h1>
</header>

<nav>
  <button onclick="showTab('login')" class="active">Login / Absen Masuk</button>
  <button onclick="showTab('izin')">Form Izin</button>
  <button onclick="showTab('pulang')">Absen Pulang</button>
</nav>

<main>
  <!-- LOGIN + ABSEN MASUK -->
  <section id="login" class="active">
    <h2>Login dan Absen Masuk</h2>
    <input type="text" id="namaLogin" placeholder="Masukkan Nama" />
    <button onclick="absenMasuk()">Absen Masuk</button>
  </section>

  <!-- FORM IZIN -->
  <section id="izin">
    <h2>Form Izin</h2>
    <p>Nama: <strong id="namaIzin"></strong></p>
    <select id="jenisIzin">
      <option value="">Pilih Jenis Izin</option>
      <option value="Toilet">Toilet</option>
      <option value="Istirahat">Istirahat</option>
      <option value="Lainnya">Lainnya</option>
    </select>
    <button onclick="mulaiIzin()">Mulai Izin</button>
    <button onclick="selesaiIzin()">Selesai Izin</button>
    <p>Durasi: <span id="durasiIzin">0 menit</span></p>
  </section>

  <!-- ABSEN PULANG -->
  <section id="pulang">
    <h2>Absen Pulang</h2>
    <p>Nama: <strong id="namaPulang"></strong></p>
    <button onclick="absenPulang()">Absen Pulang</button>
  </section>
</main>

<script>
  // Navigasi Tab
  function showTab(id) {
    document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    event.target.classList.add('active');

    if (id === 'izin') document.getElementById('namaIzin').innerText = localStorage.getItem('nama') || '-';
    if (id === 'pulang') document.getElementById('namaPulang').innerText = localStorage.getItem('nama') || '-';
  }

  // Absen Masuk
  function absenMasuk() {
    const nama = document.getElementById('namaLogin').value.trim();
    if (!nama) return alert('Nama wajib diisi!');
    localStorage.setItem('nama', nama);

    fetch('https://script.google.com/macros/s/PASTE_ID_ABSEN_MASUK/exec', {
      method: 'POST',
      body: new URLSearchParams({ nama, waktu: new Date().toLocaleString('id-ID') })
    }).then(() => alert('Absen masuk berhasil!')).catch(() => alert('Gagal absen masuk.'));
  }

  // Izin
  let waktuMulai = null;

  function mulaiIzin() {
    waktuMulai = new Date();
    alert('Izin dimulai!');
  }

  function selesaiIzin() {
    if (!waktuMulai) return alert('Klik "Mulai Izin" dulu.');
    const waktuSelesai = new Date();
    const durasi = Math.round((waktuSelesai - waktuMulai) / 60000);
    document.getElementById('durasiIzin').innerText = durasi + ' menit';

    fetch('https://script.google.com/macros/s/PASTE_ID_IZIN/exec', {
      method: 'POST',
      body: new URLSearchParams({
        nama: localStorage.getItem('nama') || 'Anonim',
        jenis: document.getElementById('jenisIzin').value,
        mulai: waktuMulai.toLocaleString('id-ID'),
        selesai: waktuSelesai.toLocaleString('id-ID'),
        durasi: durasi + ' menit'
      })
    }).then(() => alert('Data izin dikirim!')).catch(() => alert('Gagal kirim izin.'));
  }

  // Absen Pulang
  function absenPulang() {
    fetch('https://script.google.com/macros/s/PASTE_ID_PULANG/exec', {
      method: 'POST',
      body: new URLSearchParams({
        nama: localStorage.getItem('nama') || 'Anonim',
        waktu: new Date().toLocaleString('id-ID')
      })
    }).then(() => alert('Absen pulang berhasil!')).catch(() => alert('Gagal absen pulang.'));
  }
</script>
</body>
</html>
